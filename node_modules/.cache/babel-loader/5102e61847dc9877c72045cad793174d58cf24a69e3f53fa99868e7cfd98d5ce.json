{"ast":null,"code":"import { resolveComponent as _resolveComponent, createVNode as _createVNode, createTextVNode as _createTextVNode, withCtx as _withCtx, createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, normalizeClass as _normalizeClass, openBlock as _openBlock, createBlock as _createBlock, createCommentVNode as _createCommentVNode } from \"vue\";\nconst _hoisted_1 = {\n  style: {\n    \"margin-right\": \"20px\"\n  }\n};\nconst _hoisted_2 = /*#__PURE__*/_createElementVNode(\"span\", null, \"☰\", -1 /* HOISTED */);\nconst _hoisted_3 = {\n  class: \"btn_delete\"\n};\nconst _hoisted_4 = {\n  style: {\n    \"color\": \"rgb(0, 14, 58)\"\n  }\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_create_note = _resolveComponent(\"create-note\");\n  const _component_v_expansion_panel_title = _resolveComponent(\"v-expansion-panel-title\");\n  const _component_v_expansion_panel_text = _resolveComponent(\"v-expansion-panel-text\");\n  const _component_v_expansion_panel = _resolveComponent(\"v-expansion-panel\");\n  const _component_v_expansion_panels = _resolveComponent(\"v-expansion-panels\");\n  const _component_v_icon = _resolveComponent(\"v-icon\");\n  const _component_v_btn = _resolveComponent(\"v-btn\");\n  const _component_v_container = _resolveComponent(\"v-container\");\n  const _component_v_checkbox = _resolveComponent(\"v-checkbox\");\n  const _component_draggable = _resolveComponent(\"draggable\");\n  const _component_create_event = _resolveComponent(\"create-event\");\n  const _component_v_list = _resolveComponent(\"v-list\");\n  const _component_v_app = _resolveComponent(\"v-app\");\n  return _openBlock(), _createBlock(_component_v_app, null, {\n    default: _withCtx(() => [_createVNode(_component_v_container, null, {\n      default: _withCtx(() => [_createVNode(_component_create_note), _createVNode(_component_v_expansion_panels, {\n        class: \"sort\",\n        disabled: $setup.disabled,\n        style: {\n          \"margin-top\": \"20px\"\n        },\n        multiple: \"\"\n      }, {\n        default: _withCtx(() => [_createVNode(_component_v_expansion_panel, null, {\n          default: _withCtx(() => [_createVNode(_component_v_expansion_panel_title, null, {\n            default: _withCtx(() => [_createTextVNode(\"Сортировать\")]),\n            _: 1 /* STABLE */\n          }), _createVNode(_component_v_expansion_panel_text, {\n            onClick: _cache[0] || (_cache[0] = $event => $setup.sortAlphabetically())\n          }, {\n            default: _withCtx(() => [_createTextVNode(\" от А до Я \")]),\n            _: 1 /* STABLE */\n          }), _createVNode(_component_v_expansion_panel_text, {\n            onClick: _cache[1] || (_cache[1] = $event => $setup.sortAlphabeticallyMax())\n          }, {\n            default: _withCtx(() => [_createTextVNode(\" от Я до А \")]),\n            _: 1 /* STABLE */\n          }), _createVNode(_component_v_expansion_panel_text, {\n            onClick: _cache[2] || (_cache[2] = $event => $setup.sortByPriceMin())\n          }, {\n            default: _withCtx(() => [_createTextVNode(\" Цена по возрастанию \")]),\n            _: 1 /* STABLE */\n          }), _createVNode(_component_v_expansion_panel_text, {\n            onClick: _cache[3] || (_cache[3] = $event => $setup.sortByPriceMax())\n          }, {\n            default: _withCtx(() => [_createTextVNode(\" Цена по убыванию \")]),\n            _: 1 /* STABLE */\n          })]),\n\n          _: 1 /* STABLE */\n        })]),\n\n        _: 1 /* STABLE */\n      }, 8 /* PROPS */, [\"disabled\"]), _createVNode(_component_draggable, {\n        class: \"travelsList\",\n        modelValue: $options.travels,\n        \"onUpdate:modelValue\": _cache[5] || (_cache[5] = $event => $options.travels = $event),\n        \"item-key\": \"id\"\n      }, {\n        item: _withCtx(({\n          element\n        }) => [_createVNode(_component_v_list, null, {\n          default: _withCtx(() => [_createVNode(_component_v_container, {\n            class: \"handle\",\n            onClick: $event => $setup.showEvent(element),\n            style: {\n              \"display\": \"flex\",\n              \"align-items\": \"right\",\n              \"color\": \"rgb(33, 54, 124)\"\n            }\n          }, {\n            default: _withCtx(() => [_createElementVNode(\"div\", _hoisted_1, [_hoisted_2, _createElementVNode(\"strong\", null, _toDisplayString(element.title), 1 /* TEXT */)]), _createTextVNode(\" Расходы:\" + _toDisplayString($setup.getTotalPrice(element)) + \" \", 1 /* TEXT */), _createElementVNode(\"div\", _hoisted_3, [_createVNode(_component_v_btn, {\n              onClick: $event => $setup.notesStore.deleteTravel(element.id)\n            }, {\n              default: _withCtx(() => [_createVNode(_component_v_icon, null, {\n                default: _withCtx(() => [_createTextVNode(\" mdi-delete\")]),\n                _: 1 /* STABLE */\n              })]),\n\n              _: 2 /* DYNAMIC */\n            }, 1032 /* PROPS, DYNAMIC_SLOTS */, [\"onClick\"])])]),\n            _: 2 /* DYNAMIC */\n          }, 1032 /* PROPS, DYNAMIC_SLOTS */, [\"onClick\"]), element.showDetails ? (_openBlock(), _createBlock(_component_v_list, {\n            key: 0\n          }, {\n            default: _withCtx(() => [_createVNode(_component_draggable, {\n              modelValue: element.event,\n              \"onUpdate:modelValue\": $event => element.event = $event,\n              \"item-key\": $setup.id_event,\n              onEnd: $event => $options.onEventDragEnd(element)\n            }, {\n              item: _withCtx(({\n                element: event\n              }) => [_createVNode(_component_v_checkbox, {\n                modelValue: event.status,\n                \"onUpdate:modelValue\": $event => event.status = $event,\n                class: _normalizeClass({\n                  highlighted_date: event.highlighted\n                }),\n                onChange: _cache[4] || (_cache[4] = $event => $setup.notesStore.saveDataToLocalStorage())\n              }, {\n                label: _withCtx(() => [_createElementVNode(\"div\", null, [_createElementVNode(\"div\", null, _toDisplayString($options.formattedDate(event.date_start)) + \" - \" + _toDisplayString($options.formattedDate(event.date_end)) + \" Стоимость: \" + _toDisplayString(event.price), 1 /* TEXT */), _createElementVNode(\"div\", _hoisted_4, _toDisplayString(event.event_name), 1 /* TEXT */)])]),\n\n                _: 2 /* DYNAMIC */\n              }, 1032 /* PROPS, DYNAMIC_SLOTS */, [\"modelValue\", \"onUpdate:modelValue\", \"class\"]), _createVNode(_component_v_btn, {\n                icon: true,\n                onClick: $event => $setup.notesStore.deleteEvent(element.id, event.id_event)\n              }, {\n                default: _withCtx(() => [_createVNode(_component_v_icon, null, {\n                  default: _withCtx(() => [_createTextVNode(\" mdi-delete\")]),\n                  _: 1 /* STABLE */\n                })]),\n\n                _: 2 /* DYNAMIC */\n              }, 1032 /* PROPS, DYNAMIC_SLOTS */, [\"onClick\"])]),\n              _: 2 /* DYNAMIC */\n            }, 1032 /* PROPS, DYNAMIC_SLOTS */, [\"modelValue\", \"onUpdate:modelValue\", \"item-key\", \"onEnd\"]), _createVNode(_component_create_event, {\n              travelId: element.id\n            }, null, 8 /* PROPS */, [\"travelId\"])]),\n            _: 2 /* DYNAMIC */\n          }, 1024 /* DYNAMIC_SLOTS */)) : _createCommentVNode(\"v-if\", true)]),\n          _: 2 /* DYNAMIC */\n        }, 1024 /* DYNAMIC_SLOTS */)]),\n\n        _: 1 /* STABLE */\n      }, 8 /* PROPS */, [\"modelValue\"])]),\n      _: 1 /* STABLE */\n    })]),\n\n    _: 1 /* STABLE */\n  });\n}","map":{"version":3,"names":["style","_createElementVNode","class","_createBlock","_component_v_app","_createVNode","_component_v_container","_component_create_note","_component_v_expansion_panels","disabled","$setup","multiple","_component_v_expansion_panel","_component_v_expansion_panel_title","_component_v_expansion_panel_text","onClick","_cache","$event","sortAlphabetically","sortAlphabeticallyMax","sortByPriceMin","sortByPriceMax","_component_draggable","$options","travels","item","_withCtx","element","_component_v_list","showEvent","_hoisted_1","_hoisted_2","_toDisplayString","title","getTotalPrice","_hoisted_3","_component_v_btn","notesStore","deleteTravel","id","_component_v_icon","showDetails","key","event","id_event","onEnd","onEventDragEnd","_component_v_checkbox","status","_normalizeClass","highlighted_date","highlighted","onChange","saveDataToLocalStorage","label","formattedDate","date_start","date_end","price","_hoisted_4","event_name","icon","deleteEvent","_component_create_event","travelId"],"sources":["/home/abarbie/Project/travel_final/src/components/NotesTravels.vue"],"sourcesContent":["<template>\n  <v-app>\n    <v-container>\n      <create-note />\n      <v-expansion-panels\n        class=\"sort\"\n        :disabled=\"disabled\"\n        style=\"margin-top: 20px\"\n        multiple\n      >\n        <v-expansion-panel>\n          <v-expansion-panel-title>Сортировать</v-expansion-panel-title>\n          <v-expansion-panel-text @click=\"sortAlphabetically()\">\n            от А до Я\n          </v-expansion-panel-text>\n          <v-expansion-panel-text @click=\"sortAlphabeticallyMax()\">\n            от Я до А\n          </v-expansion-panel-text>\n          <v-expansion-panel-text @click=\"sortByPriceMin()\">\n            Цена по возрастанию\n          </v-expansion-panel-text>\n          <v-expansion-panel-text @click=\"sortByPriceMax()\">\n            Цена по убыванию\n          </v-expansion-panel-text>\n        </v-expansion-panel>\n      </v-expansion-panels>\n      <draggable class=\"travelsList\" v-model=\"travels\" item-key=\"id\">\n        <template #item=\"{ element }\">\n          <v-list>\n            <v-container\n              class=\"handle\"\n              @click=\"showEvent(element)\"\n              style=\"display: flex; align-items: right; color: rgb(33, 54, 124)\"\n            >\n              <div style=\"margin-right: 20px\">\n                <span>&#x2630;</span>\n                <strong>{{ element.title }}</strong>\n              </div>\n              Расходы:{{ getTotalPrice(element) }}\n              <div class=\"btn_delete\">\n                <v-btn @click=\"notesStore.deleteTravel(element.id)\"\n                  ><v-icon> mdi-delete</v-icon></v-btn\n                >\n              </div>\n            </v-container>\n\n            <v-list v-if=\"element.showDetails\">\n              <draggable\n                v-model=\"element.event\"\n                :item-key=\"id_event\"\n                @end=\"onEventDragEnd(element)\"\n              >\n                <template #item=\"{ element: event }\">\n                  <v-checkbox\n                    v-model=\"event.status\"\n                    :class=\"{ highlighted_date: event.highlighted }\"\n                    @change=\"notesStore.saveDataToLocalStorage()\"\n                  >\n                    <template #label>\n                      <div>\n                        <div>\n                          {{ formattedDate(event.date_start) }} -\n                          {{ formattedDate(event.date_end) }} Стоимость:\n                          {{ event.price }}\n                        </div>\n                        <div style=\"color: rgb(0, 14, 58)\">\n                          {{ event.event_name }}\n                        </div>\n                      </div>\n                    </template>\n                  </v-checkbox>\n                  <v-btn\n                    :icon=\"true\"\n                    @click=\"notesStore.deleteEvent(element.id, event.id_event)\"\n                    ><v-icon> mdi-delete</v-icon></v-btn\n                  >\n                </template>\n              </draggable>\n              <create-event :travelId=\"element.id\" />\n            </v-list>\n          </v-list>\n        </template>\n      </draggable>\n    </v-container>\n  </v-app>\n</template>\n\n<script>\nimport { useStore } from \"../pinia/store.js\";\nimport CreateNote from \"./CreateNote.vue\";\nimport CreateEvent from \"./CreateEvent.vue\";\nimport draggable from \"vuedraggable\";\nimport { ref } from \"vue\";\n\nexport default {\n  name: \"NoteList\",\n  components: { CreateNote, CreateEvent, draggable },\n  setup() {\n    const id_event = ref(null);\n    const notesStore = useStore();\n    const showEvent = (travel) => {\n      travel.showDetails = !travel.showDetails;\n      notesStore.saveDataToLocalStorage();\n    };\n    const disabled = ref(false);\n    const sortAlphabetically = () => {\n      notesStore.travels.sort((a, b) => a.title.localeCompare(b.title));\n    };\n    const sortAlphabeticallyMax = () => {\n      notesStore.travels.sort((a, b) => b.title.localeCompare(a.title));\n    };\n    const getTotalPrice = (travel) => {\n      if (travel && travel.event) {\n        return travel.event.reduce(\n          (total, event) => total + Number(event.price),\n          0\n        );\n      } else if (travel && !travel.event) {\n        return 0;\n      }\n    };\n    const sortByPriceMin = () => {\n      notesStore.travels.sort((a, b) => {\n        const totalPriceA = getTotalPrice(a);\n        const totalPriceB = getTotalPrice(b);\n        return totalPriceA - totalPriceB;\n      });\n    };\n    const sortByPriceMax = () => {\n      notesStore.travels.sort((a, b) => {\n        const totalPriceA = getTotalPrice(a);\n        const totalPriceB = getTotalPrice(b);\n        return totalPriceB - totalPriceA;\n      });\n    };\n    return {\n      id_event,\n      disabled,\n      showEvent,\n      notesStore,\n      sortAlphabetically,\n      sortAlphabeticallyMax,\n      getTotalPrice,\n      sortByPriceMin,\n      sortByPriceMax,\n    };\n  },\n  computed: {\n    travels: {\n      get() {\n        return this.notesStore.travels;\n      },\n      set(value) {\n        this.notesStore.updateList(value);\n      },\n    },\n  },\n  methods: {\n    onEventDragEnd(travel) {\n      // Подсвечиваем названия мероприятий красным\n      this.highlightDelayedEvents(travel.event);\n\n      // Сохраняем изменения в локальном хранилище\n      this.notesStore.saveDataToLocalStorage();\n    },\n    highlightDelayedEvents(events) {\n      for (let i = 1; i < events.length; i++) {\n        const currentEvent = events[i];\n        const previousEvent = events[i - 1];\n        if (previousEvent) {\n          const currentStartDate = new Date(currentEvent.date_start);\n          const previousStartDate = new Date(previousEvent.date_start);\n\n          if (currentStartDate < previousStartDate) {\n            // Если текущее мероприятие начинается раньше чем предыдущее, подсвечиваем красным\n            currentEvent.highlighted = true;\n          } else {\n            // Иначе убираем подсветку\n            currentEvent.highlighted = false;\n          }\n        }\n      }\n      for (let i = 0; i < events.length; i++) {\n        const currentEvent = events[i];\n        const nextEvent = events[i + 1];\n        if (nextEvent) {\n          const currentStartDate = new Date(currentEvent.date_start);\n          const nextStartDate = new Date(nextEvent.date_start);\n\n          if (currentStartDate > nextStartDate) {\n            currentEvent.highlighted = true;\n          } else {\n            currentEvent.highlighted = false;\n          }\n        }\n      }\n    },\n    formattedDate(dateString) {\n      //код форматирования даты\n      const [year, month, day] = dateString.split(\"-\");\n      return `${day}.${month}.${year}`;\n    },\n  },\n};\n</script>\n<style lang=\"scss\">\n@import \"../assets/variables.scss\";\n.highlighted_date {\n  color: red;\n}\n.handle {\n  margin-top: 1px;\n  cursor: pointer;\n}\n\n::-webkit-scrollbar {\n  width: 0px;\n}\nhr {\n  margin-top: 10px;\n}\n</style>\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}