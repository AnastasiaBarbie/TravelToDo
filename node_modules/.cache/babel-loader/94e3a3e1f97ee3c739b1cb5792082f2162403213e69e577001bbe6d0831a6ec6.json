{"ast":null,"code":"import { resolveComponent as _resolveComponent, createVNode as _createVNode, createTextVNode as _createTextVNode, withCtx as _withCtx, createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, normalizeClass as _normalizeClass, openBlock as _openBlock, createBlock as _createBlock, createCommentVNode as _createCommentVNode } from \"vue\";\nconst _hoisted_1 = {\n  style: {\n    \"margin-right\": \"20px\"\n  }\n};\nconst _hoisted_2 = /*#__PURE__*/_createElementVNode(\"span\", null, \"☰\", -1 /* HOISTED */);\nconst _hoisted_3 = {\n  class: \"btn_delete\"\n};\nconst _hoisted_4 = {\n  style: {\n    \"color\": \"rgb(0, 14, 58)\"\n  }\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_create_note = _resolveComponent(\"create-note\");\n  const _component_v_expansion_panel_title = _resolveComponent(\"v-expansion-panel-title\");\n  const _component_v_expansion_panel_text = _resolveComponent(\"v-expansion-panel-text\");\n  const _component_v_expansion_panel = _resolveComponent(\"v-expansion-panel\");\n  const _component_v_expansion_panels = _resolveComponent(\"v-expansion-panels\");\n  const _component_v_icon = _resolveComponent(\"v-icon\");\n  const _component_v_btn = _resolveComponent(\"v-btn\");\n  const _component_v_container = _resolveComponent(\"v-container\");\n  const _component_v_checkbox = _resolveComponent(\"v-checkbox\");\n  const _component_v_col = _resolveComponent(\"v-col\");\n  const _component_v_row = _resolveComponent(\"v-row\");\n  const _component_draggable = _resolveComponent(\"draggable\");\n  const _component_create_event = _resolveComponent(\"create-event\");\n  const _component_v_list = _resolveComponent(\"v-list\");\n  const _component_v_app = _resolveComponent(\"v-app\");\n  return _openBlock(), _createBlock(_component_v_app, null, {\n    default: _withCtx(() => [_createVNode(_component_create_note), _createVNode(_component_v_expansion_panels, {\n      class: \"sort\",\n      disabled: $setup.disabled,\n      style: {\n        \"margin-top\": \"20px\"\n      },\n      multiple: \"\"\n    }, {\n      default: _withCtx(() => [_createVNode(_component_v_expansion_panel, null, {\n        default: _withCtx(() => [_createVNode(_component_v_expansion_panel_title, null, {\n          default: _withCtx(() => [_createTextVNode(\"Сортировать\")]),\n          _: 1 /* STABLE */\n        }), _createVNode(_component_v_expansion_panel_text, {\n          onClick: _cache[0] || (_cache[0] = $event => $setup.sortAlphabetically())\n        }, {\n          default: _withCtx(() => [_createTextVNode(\" от А до Я \")]),\n          _: 1 /* STABLE */\n        }), _createVNode(_component_v_expansion_panel_text, {\n          onClick: _cache[1] || (_cache[1] = $event => $setup.sortAlphabeticallyMax())\n        }, {\n          default: _withCtx(() => [_createTextVNode(\" от Я до А \")]),\n          _: 1 /* STABLE */\n        }), _createVNode(_component_v_expansion_panel_text, {\n          onClick: _cache[2] || (_cache[2] = $event => $setup.sortByPriceMin())\n        }, {\n          default: _withCtx(() => [_createTextVNode(\" Цена по возрастанию \")]),\n          _: 1 /* STABLE */\n        }), _createVNode(_component_v_expansion_panel_text, {\n          onClick: _cache[3] || (_cache[3] = $event => $setup.sortByPriceMax())\n        }, {\n          default: _withCtx(() => [_createTextVNode(\" Цена по убыванию \")]),\n          _: 1 /* STABLE */\n        })]),\n\n        _: 1 /* STABLE */\n      })]),\n\n      _: 1 /* STABLE */\n    }, 8 /* PROPS */, [\"disabled\"]), _createVNode(_component_draggable, {\n      class: \"travelsList\",\n      modelValue: $options.travels,\n      \"onUpdate:modelValue\": _cache[5] || (_cache[5] = $event => $options.travels = $event),\n      \"item-key\": \"id\"\n    }, {\n      item: _withCtx(({\n        element\n      }) => [_createVNode(_component_v_list, null, {\n        default: _withCtx(() => [_createVNode(_component_v_container, {\n          class: \"handle\",\n          onClick: $event => $setup.showEvent(element),\n          style: {\n            \"display\": \"flex\",\n            \"align-items\": \"right\",\n            \"color\": \"rgb(33, 54, 124)\"\n          }\n        }, {\n          default: _withCtx(() => [_createElementVNode(\"div\", _hoisted_1, [_hoisted_2, _createElementVNode(\"strong\", null, _toDisplayString(element.title), 1 /* TEXT */)]), _createTextVNode(\" Расходы:\" + _toDisplayString($setup.getTotalPrice(element)) + \" \", 1 /* TEXT */), _createElementVNode(\"div\", _hoisted_3, [_createVNode(_component_v_btn, {\n            onClick: $event => $setup.notesStore.deleteTravel(element.id)\n          }, {\n            default: _withCtx(() => [_createVNode(_component_v_icon, null, {\n              default: _withCtx(() => [_createTextVNode(\" mdi-delete\")]),\n              _: 1 /* STABLE */\n            })]),\n\n            _: 2 /* DYNAMIC */\n          }, 1032 /* PROPS, DYNAMIC_SLOTS */, [\"onClick\"])])]),\n          _: 2 /* DYNAMIC */\n        }, 1032 /* PROPS, DYNAMIC_SLOTS */, [\"onClick\"]), element.showDetails ? (_openBlock(), _createBlock(_component_v_list, {\n          key: 0\n        }, {\n          default: _withCtx(() => [_createVNode(_component_draggable, {\n            modelValue: element.event,\n            \"onUpdate:modelValue\": $event => element.event = $event,\n            \"item-key\": $setup.id_event,\n            onEnd: $event => $options.onEventDragEnd(element)\n          }, {\n            item: _withCtx(({\n              element: event\n            }) => [_createVNode(_component_v_row, null, {\n              default: _withCtx(() => [_createVNode(_component_v_col, {\n                align: \"left\"\n              }, {\n                default: _withCtx(() => [_createVNode(_component_v_checkbox, {\n                  modelValue: event.status,\n                  \"onUpdate:modelValue\": $event => event.status = $event,\n                  class: _normalizeClass({\n                    highlighted_date: event.highlighted\n                  }),\n                  onChange: _cache[4] || (_cache[4] = $event => $setup.notesStore.saveDataToLocalStorage())\n                }, {\n                  label: _withCtx(() => [_createElementVNode(\"div\", null, [_createElementVNode(\"div\", null, _toDisplayString($options.formattedDate(event.date_start)) + \" - \" + _toDisplayString($options.formattedDate(event.date_end)) + \" Стоимость: \" + _toDisplayString(event.price), 1 /* TEXT */), _createElementVNode(\"div\", _hoisted_4, _toDisplayString(event.event_name), 1 /* TEXT */)])]),\n\n                  _: 2 /* DYNAMIC */\n                }, 1032 /* PROPS, DYNAMIC_SLOTS */, [\"modelValue\", \"onUpdate:modelValue\", \"class\"])]),\n                _: 2 /* DYNAMIC */\n              }, 1024 /* DYNAMIC_SLOTS */), _createVNode(_component_v_col, {\n                align: \"right\"\n              }, {\n                default: _withCtx(() => [_createVNode(_component_v_btn, {\n                  icon: true,\n                  onClick: $event => $setup.notesStore.deleteEvent(element.id, event.id_event)\n                }, {\n                  default: _withCtx(() => [_createVNode(_component_v_icon, null, {\n                    default: _withCtx(() => [_createTextVNode(\" mdi-delete\")]),\n                    _: 1 /* STABLE */\n                  })]),\n\n                  _: 2 /* DYNAMIC */\n                }, 1032 /* PROPS, DYNAMIC_SLOTS */, [\"onClick\"])]),\n                _: 2 /* DYNAMIC */\n              }, 1024 /* DYNAMIC_SLOTS */)]),\n\n              _: 2 /* DYNAMIC */\n            }, 1024 /* DYNAMIC_SLOTS */)]),\n\n            _: 2 /* DYNAMIC */\n          }, 1032 /* PROPS, DYNAMIC_SLOTS */, [\"modelValue\", \"onUpdate:modelValue\", \"item-key\", \"onEnd\"]), _createVNode(_component_create_event, {\n            travelId: element.id\n          }, null, 8 /* PROPS */, [\"travelId\"])]),\n          _: 2 /* DYNAMIC */\n        }, 1024 /* DYNAMIC_SLOTS */)) : _createCommentVNode(\"v-if\", true)]),\n        _: 2 /* DYNAMIC */\n      }, 1024 /* DYNAMIC_SLOTS */)]),\n\n      _: 1 /* STABLE */\n    }, 8 /* PROPS */, [\"modelValue\"])]),\n    _: 1 /* STABLE */\n  });\n}","map":{"version":3,"names":["style","_createElementVNode","class","_createBlock","_component_v_app","_createVNode","_component_create_note","_component_v_expansion_panels","disabled","$setup","multiple","_component_v_expansion_panel","_component_v_expansion_panel_title","_component_v_expansion_panel_text","onClick","_cache","$event","sortAlphabetically","sortAlphabeticallyMax","sortByPriceMin","sortByPriceMax","_component_draggable","$options","travels","item","_withCtx","element","_component_v_list","_component_v_container","showEvent","_hoisted_1","_hoisted_2","_toDisplayString","title","getTotalPrice","_hoisted_3","_component_v_btn","notesStore","deleteTravel","id","_component_v_icon","showDetails","key","event","id_event","onEnd","onEventDragEnd","_component_v_row","_component_v_col","align","_component_v_checkbox","status","_normalizeClass","highlighted_date","highlighted","onChange","saveDataToLocalStorage","label","formattedDate","date_start","date_end","price","_hoisted_4","event_name","icon","deleteEvent","_component_create_event","travelId"],"sources":["/home/abarbie/Project/travel_final/src/components/NotesTravels.vue"],"sourcesContent":["<template>\n  <v-app>\n    <create-note />\n    <v-expansion-panels\n      class=\"sort\"\n      :disabled=\"disabled\"\n      style=\"margin-top: 20px\"\n      multiple\n    >\n      <v-expansion-panel>\n        <v-expansion-panel-title>Сортировать</v-expansion-panel-title>\n        <v-expansion-panel-text @click=\"sortAlphabetically()\">\n          от А до Я\n        </v-expansion-panel-text>\n        <v-expansion-panel-text @click=\"sortAlphabeticallyMax()\">\n          от Я до А\n        </v-expansion-panel-text>\n        <v-expansion-panel-text @click=\"sortByPriceMin()\">\n          Цена по возрастанию\n        </v-expansion-panel-text>\n        <v-expansion-panel-text @click=\"sortByPriceMax()\">\n          Цена по убыванию\n        </v-expansion-panel-text>\n      </v-expansion-panel>\n    </v-expansion-panels>\n    <draggable class=\"travelsList\" v-model=\"travels\" item-key=\"id\">\n      <template #item=\"{ element }\">\n        <v-list>\n          <v-container\n            class=\"handle\"\n            @click=\"showEvent(element)\"\n            style=\"display: flex; align-items: right; color: rgb(33, 54, 124)\"\n          >\n            <div style=\"margin-right: 20px\">\n              <span>&#x2630;</span>\n              <strong>{{ element.title }}</strong>\n            </div>\n            Расходы:{{ getTotalPrice(element) }}\n            <div class=\"btn_delete\">\n              <v-btn @click=\"notesStore.deleteTravel(element.id)\"\n                ><v-icon> mdi-delete</v-icon></v-btn\n              >\n            </div>\n          </v-container>\n\n          <v-list v-if=\"element.showDetails\">\n            <draggable\n              v-model=\"element.event\"\n              :item-key=\"id_event\"\n              @end=\"onEventDragEnd(element)\"\n            >\n              <template #item=\"{ element: event }\">\n                <v-row>\n                  <v-col align=\"left\">\n                    <v-checkbox\n                      v-model=\"event.status\"\n                      :class=\"{ highlighted_date: event.highlighted }\"\n                      @change=\"notesStore.saveDataToLocalStorage()\"\n                    >\n                      <template #label>\n                        <div>\n                          <div>\n                            {{ formattedDate(event.date_start) }} -\n                            {{ formattedDate(event.date_end) }} Стоимость:\n                            {{ event.price }}\n                          </div>\n                          <div style=\"color: rgb(0, 14, 58)\">\n                            {{ event.event_name }}\n                          </div>\n                        </div>\n                      </template>\n                    </v-checkbox>\n                  </v-col>\n                  <v-col align=\"right\">\n                    <v-btn\n                      :icon=\"true\"\n                      @click=\"\n                        notesStore.deleteEvent(element.id, event.id_event)\n                      \"\n                      ><v-icon> mdi-delete</v-icon></v-btn\n                    >\n                  </v-col>\n                </v-row>\n              </template>\n            </draggable>\n            <create-event :travelId=\"element.id\" />\n          </v-list>\n        </v-list>\n      </template>\n    </draggable>\n  </v-app>\n</template>\n\n<script>\nimport { useStore } from \"../pinia/store.js\";\nimport CreateNote from \"./CreateNote.vue\";\nimport CreateEvent from \"./CreateEvent.vue\";\nimport draggable from \"vuedraggable\";\nimport { ref } from \"vue\";\n\nexport default {\n  name: \"NoteList\",\n  components: { CreateNote, CreateEvent, draggable },\n  setup() {\n    const id_event = ref(null);\n    const notesStore = useStore();\n    const showEvent = (travel) => {\n      travel.showDetails = !travel.showDetails;\n      notesStore.saveDataToLocalStorage();\n    };\n    const disabled = ref(false);\n    const sortAlphabetically = () => {\n      notesStore.travels.sort((a, b) => a.title.localeCompare(b.title));\n    };\n    const sortAlphabeticallyMax = () => {\n      notesStore.travels.sort((a, b) => b.title.localeCompare(a.title));\n    };\n    const getTotalPrice = (travel) => {\n      if (travel && travel.event) {\n        return travel.event.reduce(\n          (total, event) => total + Number(event.price),\n          0\n        );\n      } else if (travel && !travel.event) {\n        return 0;\n      }\n    };\n    const sortByPriceMin = () => {\n      notesStore.travels.sort((a, b) => {\n        const totalPriceA = getTotalPrice(a);\n        const totalPriceB = getTotalPrice(b);\n        return totalPriceA - totalPriceB;\n      });\n    };\n    const sortByPriceMax = () => {\n      notesStore.travels.sort((a, b) => {\n        const totalPriceA = getTotalPrice(a);\n        const totalPriceB = getTotalPrice(b);\n        return totalPriceB - totalPriceA;\n      });\n    };\n    return {\n      id_event,\n      disabled,\n      showEvent,\n      notesStore,\n      sortAlphabetically,\n      sortAlphabeticallyMax,\n      getTotalPrice,\n      sortByPriceMin,\n      sortByPriceMax,\n    };\n  },\n  computed: {\n    travels: {\n      get() {\n        return this.notesStore.travels;\n      },\n      set(value) {\n        this.notesStore.updateList(value);\n      },\n    },\n  },\n  methods: {\n    onEventDragEnd(travel) {\n      // Подсвечиваем названия мероприятий красным\n      this.highlightDelayedEvents(travel.event);\n\n      // Сохраняем изменения в локальном хранилище\n      this.notesStore.saveDataToLocalStorage();\n    },\n    highlightDelayedEvents(events) {\n      for (let i = 1; i < events.length; i++) {\n        const currentEvent = events[i];\n        const previousEvent = events[i - 1];\n        if (previousEvent) {\n          const currentStartDate = new Date(currentEvent.date_start);\n          const previousStartDate = new Date(previousEvent.date_start);\n\n          if (currentStartDate < previousStartDate) {\n            // Если текущее мероприятие начинается раньше чем предыдущее, подсвечиваем красным\n            currentEvent.highlighted = true;\n          } else {\n            // Иначе убираем подсветку\n            currentEvent.highlighted = false;\n          }\n        }\n      }\n      for (let i = 0; i < events.length; i++) {\n        const currentEvent = events[i];\n        const nextEvent = events[i + 1];\n        if (nextEvent) {\n          const currentStartDate = new Date(currentEvent.date_start);\n          const nextStartDate = new Date(nextEvent.date_start);\n\n          if (currentStartDate > nextStartDate) {\n            currentEvent.highlighted = true;\n          } else {\n            currentEvent.highlighted = false;\n          }\n        }\n      }\n    },\n    formattedDate(dateString) {\n      //код форматирования даты\n      const [year, month, day] = dateString.split(\"-\");\n      return `${day}.${month}.${year}`;\n    },\n  },\n};\n</script>\n<style lang=\"scss\">\n@import \"../assets/variables.scss\";\n.highlighted_date {\n  color: red;\n}\n.handle {\n  margin-top: 1px;\n  cursor: pointer;\n}\n\n::-webkit-scrollbar {\n  width: 0px;\n}\nhr {\n  margin-top: 10px;\n}\n</style>\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}